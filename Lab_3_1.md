# Уравнивание минимально-ограниченной и свободной нивелирных сетей

**Цель**: выполнить уравнивание минимально-ограниченной и свободной
нивелирных сетей. Произвести оценку точности полученных результатов,
выполнить статистический тест на наличие грубых ошибок в результатах
измерений.

Исходные данные, использованные в ходе лабораторной работы, представлены
в таблице 1.

## Таблица 1 - Исходные данные

| От  | до  | до     | h, м | S, км | Класс |
| --- | --- | ------ | ---- | ----- | ----- |
| M01 | Rp1 | 0,543  | 3,4  | IV    |       |
| Rp1 | Rp2 | -1,418 | 5,6  | IV    |       |
| Rp2 | Rp3 | 2,336  | 2,7  | IV    |       |
| Rp3 | M02 | -2,479 | 5,2  | IV    |       |
| Rp4 | Rp1 | 0,762  | 5    | IV    |       |
| Rp2 | Rp4 | 0,691  | 2,7  | IV    |       |
| Rp4 | Rp3 | 1,665  | 2,6  | IV    |       |
| M02 | Rp4 | 0,806  | 5,4  | IV    |       |

Высотные отметки исходных точек
| Точка        | H, м    |
| ------------ | ------- |
| $H_{M_{01}}$ | 102,566 |
| $H_{M_{02}}$ | 102,566 |

# УРАВНИВАНИЕ МИНИМАЛЬНО-ОГРАНИЧЕННОЙ НИВЕЛИРНОЙ СЕТИ 

Назначим параметры:

$$
\begin{matrix}
z_1 = H_{Rp_1}^0 = H_{M_{01}} + h_1 \\
z_2 = H_{Rp_2}^0 = H_{M_{01}} + h_1 + h_2 \\
z_3 = H_{Rp_3}^0 = H_{M_{01}} + h_1 + h_2 + h_3 \\
z_4 = H_{Rp_1}^0 = H_{M_{01}} + h_1 + h_2 + h_3 + h_4 \\
z_5 = H_{Rp_1}^0 = H_{M_{01}} + h_1 - h_5 \\
z_1 = z_2 = z_3 = z_4 = z_5 = 0 \\
\end{matrix}
$$

где $z$ - – приближенное значение параметра.

Составим параметрические уравнения связи и вычислим приближенные
значения измерений

$$
\begin{matrix}
h_1^0 = z_1 - H_{M_1} \\
h_2^0 = z_2 - z_1 \\
h_3^0 = z_3 - z_2 \\
z_4^0 = z_4 - z_3 \\
h_5^0 = z_1 - z_5 \\
h_6^0 = z_5 - z_2 \\
h_7^0 = z_3 - z_5 \\
h_8^0 = z_5 - z_4 \\
\end{matrix}
$$

Найдем элементы вектора свободных членов по формуле:

$$
l_n = \left( h_{выч} - h_{изм} \right)
$$

| № | $h_{выч}$, м | $h_{изм}$, м | l, м     |
| - | ------------ | ------------ | -------- |
| 1 | -102,566     | 0,543        | -103,109 |
| 2 | 0            | -1,418       | 1,418    |
| 3 | 0            | 2,336        | -2,336   |
| 4 | 0            | -2,479       | 2,479    |
| 5 | 0            | 0,762        | -0,762   |
| 6 | 0            | 0,691        | -0,691   |
| 7 | 0            | 1,665        | -1,665   |
| 8 | 0            | 0,806        | -0,806   |

Создадим матрицу коэффициентов параметрических уравнений поправок $A$.

Для составления матрицы $А$ используем формулу переноса ошибок:

$$
F = f(a,b)
$$

$$
m_F^2 = \left( \frac{ \partial F }{\partial a} \right)^2 \cdot m_a^2 + \left( \frac{ \partial F }{\partial b} \right)^2 \cdot m_b^2
$$

В нашем случае дифференцируем параметрические уравнения связи по каждому параметру. 
Например, третья строка матрицы $А$ рассчитывается следующим образом:

$$
h_3 = z_3 - z_2
$$

$$
m_{h_3}^2 = \left( \frac{ \partial f}{\partial z_1} \right) \cdot m_{z_1}^2 + \left( \frac{ \partial f}{\partial z_2} \right) \cdot m_{z_2}^2 + \left( \frac{ \partial f}{\partial z_3} \right) \cdot m_{z_3}^2 + \left( \frac{ \partial f}{\partial z_4} \right) \cdot m_{z_4}^2 + \left( \frac{ \partial f}{\partial z_5} \right) \cdot m_{z_5}^2
$$

$$
0^0 \cdot m_{z_1}^2 + (-1)^2 \cdot m_{z_2}^2 + 1^2 \cdot m_{z_3}^2 + 0^2 \cdot m_{z_4}^2 + 0^2 \cdot m_{z_5}^2
$$

$$
0 -1 1 0 0
$$

$$
\begin{pmatrix}
1 & 0 & 0 & 0 & 0 \\
1 & 1 & 0 & 0 & 0 \\
0 & 1 & 1 & 0 & 0 \\
0 & 0 & 1 & 1 & 0 \\
1 & 0 & 0 & 0 & 1 \\
0 & 1 & 0 & 0 & 1 \\
0 & 0 & 1 & 0 & 1 \\
0 & 0 & 0 & 1 & 1 \\
\end{pmatrix}
$$

Создадим диагональную матрицу весов $P$, uде вес рассчитывается по формуле:

$$
P = \left( \frac{1}{\sigma_0 \cdot \sqrt{L}} \right)^2
$$

где $L$ - длина хода, км

$$
P = \begin{pmatrix}
735 & 0 & 0 & 0 & 0 & 0 & 0 & 0  \\
0 & 446 & 0 & 0 & 0 & 0 & 0 & 0  \\
0 & 0 & 926 & 0 & 0 & 0 & 0 & 0  \\
0 & 0 & 0 & 481 & 0 & 0 & 0 & 0  \\
0 & 0 & 0 & 0 & 500 & 0 & 0 & 0  \\
0 & 0 & 0 & 0 & 0 & 926 & 0 & 0  \\
0 & 0 & 0 & 0 & 0 & 0 & 962 & 0  \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 463  \\
\end{pmatrix}
$$

Контрольные суммы $S$ находим по формуле:

$$
S_n = a_{n_1} + a_{n_2} + a_{n_3} + a_{n_4} + l_n
$$

## Таблица 2 – Контрольные суммы $S$

| № | S      | № | S      |
| - | ------ | - | ------ |
| 1 | -0.543 | 5 | -0,762 |
| 2 | 1,418  | 6 | -0,691 |
| 3 | -2,336 | 7 | -1,665 |
| 4 | 2,479  | 8 | -0,806 |

Cоставим матрицу коэффициентов нормальных уравнений $N$ и найдем ее элементы. 
Матрица коэффициентов нормальных уравнений $N$ имеет вид:

|         | $a_1]$   | $a_2]$   | $a_3]$   | $a_4]$   | $l]$  | $S]$  | $C]$  |
| ------- | -------- | -------- | -------- | -------- | ----- | ----- | ----- |
| $[pa_1$ | $N_{11}$ | $N_{12}$ | $N_{13}$ | $N_{14}$ | $B_1$ | $S_1$ | $C_1$ |
| $[pa_2$ | $N_{21}$ | $N_{22}$ | $N_{23}$ | $N_{24}$ | $B_2$ | $S_2$ | $C_2$ |
| $[pa_3$ | $N_{31}$ | $N_{32}$ | $N_{33}$ | $N_{34}$ | $B_3$ | $S_3$ | $C_3$ |
| $[pa_4$ | $N_{41}$ | $N_{42}$ | $N_{43}$ | $N_{44}$ | $B_4$ | $S_4$ | $C_4$ |
| $[pa_5$ | $N_{51}$ | $N_{52}$ | $N_{53}$ | $N_{54}$ | $B_5$ | $S_5$ | $C_5$ |

Расчёт матрицы коэффициентов нормальных уравнений $N$ в матричном виде

$$
N = A^T \cdot P \cdot A
$$

Расчёт матрицы свободных членов нормальных уравнений $B$ в матричном виде:

$$
B = A^T \cdot P \cdot l
$$

|         | $a_1$]  | $a_2]$  | $a_3]$  | $a_4]$ | $a_5]$  | $l]$      | $S]$     | $С]$     |
| ------- | ------- | ------- | ------- | ------ | ------- | --------- | -------- | -------- |
| $[pa_1$ | 1681,72 | -446,43 | 0       | 0      | -500,00 | -76829,47 | -102,109 | -102,109 |
| $[pa_2$ | -446,43 | 2298,28 | -925,93 | 0      | -925,93 | 3435,813  | 1,418    | 1,418    |
| $[pa_3$ | 0       | -925,93 | 2368,23 | -480,7 | -961,54 | -4955,751 | -2,336   | -2,236   |
| $[pa_4$ | 0       | 0       | -480,77 | 943,73 | -462,96 | 1564,975  | 2,479    | 2,479    |
| $[pa_5$ | -500,00 | -925,93 | -961,54 | -462,9 | 2850,43 | 968,999   | -0,762   | -0,762   |

Расчёт вектора высот $H$ в матричном виде

$$
H = -N^{-1} \cdot B
$$

$$
H = \begin{pmatrix}
103,109   \\
101,679   \\
104,020   \\
101,547   \\
102,358   \\
\end{pmatrix}
$$

Далее вычисляем уравненные превышения

$$
\begin{pmatrix}
h_1^{ур} = H_{Rp_1} - H_{M_1} & h_5^{ур} = H_{Rp_1} - H_{Rp_4}     \\
h_2^{ур} = H_{Rp_2} - H_{Rp_1} & h_6^{ур} = H_{Rp_4} - H_{Rp_2}  \\
h_3^{ур} = H_{Rp_3} - H_{Rp_2} & h_7^{ур} = H_{Rp_3} - H_{Rp_4}  \\
h_4^{ур} = H_{M_2} - H_{Rp_3} & h_8^{ур} = H_{Rp_4} - H_{M_2}  \\
\end{pmatrix}
$$

Вычисляем уравненные поправки

$$
\nu_n = h_n^{ур} - h_n
$$

$$
h^{ур} = \begin{pmatrix}
0,543   \\
1, 430  \\
2,342   \\
2, 474  \\
0,751   \\
0,679   \\
1,662   \\
0,811   \\
\end{pmatrix}м
$$

$$
\nu = \begin{pmatrix}
0,000  \\
-0,012 \\
0,006  \\
0,005  \\
-0,011 \\
-0,012 \\
-0,003 \\
0,005  \\
\end{pmatrix}м
$$

Проверяем отметки реперов вычислив их несколькими способами, т.е. через
разные превышения:

$$
\begin{cases}
H_{Rp_4} = H_{M_1} + h_1^{ур} - h_5^{ур} = 102,358 м \\
H_{Rp_4} = H_{M_1} + h_1^{ур} + h_2^{ур} + h_6^{ур} = 102,358 м \\
H_{Rp_4} = H_{M_1} + h_1^{ур} + h_2^{ур} + h_3^{ур} + h_4^{ур} + h_8^{ур} = 102,358 м \\
\end{cases}
$$

#ОЦЕНКА ТОЧНОСТИ МИНИМАЛЬНО-ОГРАНИЧЕННОГО УРАВНИВАНИЯ

Рассчитаем ковариационную матрицу уравненных превышений

$$
Q_{ур}^h = A \cdot N^{-1} \cdot A^T
$$

$$
Q_{ур}^h = \begin{pmatrix}
0.0014 & 0 & 0 & 0 & 0 & 0 & 0 & 0                                   \\
0 & 0,0012 & -0,0003 & -0,0003 & -0,0006 & -0,0006 & 0,0001 & 0,0002 \\
0 & -0,0003 & 0,0007 & -0,0002 & -0,0001 & 0,0001 & 0,0003 & -0,0001 \\
0 & -0,0003 & -0,0002 & 0,0012 & 0,0002 & 0,0002 & -0,0003 & -0,0006 \\
0 & -0,0006 & -0,0001 & 0,0002 & 0,0012 & -0,0008 & 0,0002 & -0,0004 \\
0 & -0,0004 & 0,0003 & 0,0001 & -0,0002 & 0,0006 & -0,0003 & 0,0002  \\
0 & 0,0001 & 0,0003 & -0,0003 & 0,0002 & -0,0002 & 0,0006 & -0,0002  \\
0 & 0,0002 & -0,0001 & -0,0006 & -0,004 & 0,0004 & -0,0002 & 0,0012  \\
\end{pmatrix}
$$

Рассчитаем ковариационную матрицу уравненных отметок реперов

$$
Q_{ур}^H = N^{-1}
$$

$$
Q_{ур}^H = \begin{pmatrix}
0,0014 0,0014 0,0014 0,0014 0,0014 \\
0,0014 0,0026 0,0024 0,0023 0,0023 \\
0,0014 0,0024 0,0029 0,0027 0,0024 \\
0,0014 0,0023 0,0027 0,0036 0,0025 \\
0,0014 0,0023 0,0024 0,0025 0,0025 \\
\end{pmatrix}
$$

СКП единицы веса

$$
\mu = \sqrt{\frac{V^T \cdot P \cdot V}{N - t}}
$$

,где $V^T \cdot P \cdot V = 9,499$, $\mu = 0,975$

СКП превышений

$$
\begin{pmatrix}
m_{h_1} \\
m_{h_2} \\
m_{h_3} \\
m_{h_4} \\
m_{h_5} \\
m_{h_6} \\
m_{h_7} \\
m_{h_8} \\
\end{pmatrix} = \begin{pmatrix}
\sqrt{Q_{11}^h} \\
\sqrt{Q_{22}^h} \\
\sqrt{Q_{33}^h} \\
\sqrt{Q_{44}^h} \\
\sqrt{Q_{55}^h} \\
\sqrt{Q_{66}^h} \\
\sqrt{Q_{77}^h} \\
\sqrt{Q_{88}^h} \\
\end{pmatrix} = \begin{pmatrix}
0,0139 \\
0,0148 \\
0,0120 \\
0,0146 \\
0,0138 \\
0,0116 \\
0,0114 \\
0,0139 \\
\end{pmatrix}
$$

СКП реперов

$$
\begin{pmatrix}
m_{H_1} \\
m_{H_2} \\
m_{H_3} \\
m_{H_4} \\
m_{H_5} \\
\end{pmatrix} = \mu \begin{pmatrix}
\sqrt{Q_{11}^H} \\
\sqrt{Q_{22}^H} \\
\sqrt{Q_{33}^H} \\
\sqrt{Q_{44}^H} \\
\sqrt{Q_{55}^H} \\
\end{pmatrix} =
\begin{pmatrix}
0,0120 \\
0,0165 \\
0,0175 \\
0,0196 \\
0,0164 \\
\end{pmatrix}
$$
# Коррелатный способ уравнивания нивелирных сетей

Цель: выполнить уравнивание коррелатным способом сеть нивелирования
III класса. Вычислить уравненные высотные отметки, произвести обобщенную
оценку точности полученных результатов. Провести поиск грубых ошибок,
используя $τ$ – тест.

Исходные данные, использованные в ходе лабораторной работы,
представлены ниже.

## Таблица 1 – Исходные данные

| от | до |h | м| S | км | Класс |
|:--:|:--:|:--:|:--: |:--:|  :--: |:--:|
| Rp1 | Rp3 | h1  | 1,879  | S1  | 5,5 | III |
| Rp1 | Rp4 | h2  | 1,589  | S2  | 10  | III |
| Rp1 | Rp8 | h3  | 1,469  | S3  | 8,4 | III |
| Rp1 | Rp9 | h4  | -1,038 | S4  | 6,5 | III |
| Rp2 | Rp3 | h5  | 4,697  | S5  | 9,6 | III |
| Rp2 | Rp6 | h6  | 2,680  | S6  | 5,9 | III |
| Rp2 | Rp9 | h7  | 1,691  | S7  | 8,1 | III |
| Rp3 | Rp6 | h8  | -2,028 | S8  | 7,7 | III |
| Rp3 | Rp8 | h9  | -0,432 | S9  | 5,6 | III |
| Rp4 | Rp5 | h10 | 0,073  | S10 | 3,4 | III |
| Rp4 | Rp7 | h11 | -0,812 | S11 | 6,2 | III |
| Rp4 | Rp9 | h12 | -2,695 | S12 | 3,3 | III |
| Rp5 | Rp6 | h13 | -1,788 | S13 | 9,8 | III |
| Rp5 | Rp7 | h14 | -0,906 | S14 | 2,8 | III |
| Rp5 | Rp8 | h15 | -0,141 | S15 | 6,6 | III |
| Rp6 | Rp8 | h16 | 1,642  | S16 | 6,5 | III |
| Rp7 | Rp9 | h17 | -1,852 | S17 | 5,9 | III |

## Высотные отметки исходных реперов H, м
| $H_{Rp1}$ | $H_{Rp2}$ |
|:--:|:--:|
| 180,489 | 177, 681 |

## Схема нивелирной сети

# УРАВНИВАНИЕ НИВЕЛИРНОЙ СЕТИ И ОПРЕДЕЛЕНИЕ УРАВНЕННЫХ ОТМЕТОК РЕПЕРОВ

Проанализируем нивелирную сеть, приведённую на рисунке 1.

1. В данной сети десять избыточных измерений $r = N – t = 17 – 7 = 10$.
2. По числу избыточных измерений необходимо составить десять условных уравнения поправок.

Условные уравнения поправок будут иметь вид:

$$
\begin{matrix}
h_4 - h_{12} - h_2 = w_1 \\
h_2 + h_{10} + h_15 - h_3 = w_2 \\
h_3 - h_{9} - h_1 - h_5 = w_3 \\
h_7 - h_{4} + h_1 - h_5 = w_4 \\
h_5 + h_{8} - h_6 = w_5 \\ 
h_9 - h_{16} - h_8 = w_6 \\
h_{16} - h_{15} - h_{13} = w_7 \\ 
h_{11} - h_{14} - h_{10} = w_8 \\
h_{12} - h_{17} - h_{11} = w_9 \\
h_{1} - h_{5} - (H_{Rp2} - H_{Rp1}) = w_{10} \\
\end{matrix}
$$

Создаём вектор невязок $W$

$$
W=
\begin{pmatrix}
0,068 \\
0,052 \\
0,022 \\
-0,089 \\
-0,011 \\
-0,046 \\
-0,005 \\
0,021 \\
-0,031 \\
-0,010 \\
\end{pmatrix}
$$

Вычисляем допустимые невязки реперов (для III класса) по формуле:

$$
w_{доп} = 10 \cdot \sqrt{L}
$$

где $L$ – длина хода, км.

$$
\begin{matrix}
w_{1_{доп}} = 0,044м \\
w_{2_{доп}} = 0,053м \\
w_{3_{доп}} = 0,044м \\
w_{4_{доп}} = 0,054м \\
w_{5_{доп}} = 0,048м \\
w_{6_{доп}} = 0,044м \\
w_{7_{доп}} = 0,048м \\
w_{8_{доп}} = 0,035м \\
w_{9_{доп}} = 0,026м \\
w_{10_{доп}} = 0,039м \\
\end{matrix}
$$

Невязки под номерами 1,4,6,9 не допустимы. 

Коэффициент при превышении равняется:<br/>
+1, если направление хода и полигона совпадают;<br/>
–1, если направление хода и полигона не совпадают;<br/>
0, если в полигоне нет данного хода.

Создадим матрицу коэффициентов условных уравнений поправок B:

$$
B =
\begin{pmatrix}
0 & -1 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 1 & -1 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
-1 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & -1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
1 & 0 & 0 & -1 & -1 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 1 & -1 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & -1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & -1 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & -1 & 1 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -1 & 1 & 0 & 0 & -1 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -1 & 1 & 0 & 0 & 0 & 0 & -1 \\
1 & 0 & 0 & 0 & -1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
\end{pmatrix}
$$

Создадим диагональную матрицу весов $P$, где вес рассчитывается по формуле:

$$
P = \left( \frac{1}{\sigma_0 \cdot \sqrt{L}} \right)^2
$$

где $L$ – длина хода, км.

$$
P = 
\begin{pmatrix}
1818 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 1000 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 1190 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 1538 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 1042 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 1695 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 1235 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 1299 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1786 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 2941 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1613 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 3030 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1020 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 3571 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1515 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1538 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1695 \\
\end{pmatrix}
$$

Вычислим матрицу коэффициентов нормальных уравнений $R$

Расчёт матрицы коэффициентов нормальных уравнений $R$ в матричном
виде

$$
R = B \cdot P^{-1} \cdot B^T
$$

$$
R = 
\begin{pmatrix}
0,002 & 0,001 & 0 & 0,001 & 0 & 0 & 0 & 0 & 0 & 0 \\
0,001 & 0,003 & 0,001 & 0 & 0 & 0 & 0,001 & 0 & 0 & 0 \\
0 & 0,001 & 0,002 & 0,001 & 0 & 0,001 & 0 & 0 & 0 & 0,001 \\
0,001 & 0 & 0,001 & 0,003 & 0,001 & 0 & 0 & 0 & 0 & 0,002 \\
0 & 0 & 0 & 0,001 & 0,002 & 0,001 & 0 & 0 & 0 & 0,001 \\
0 & 0 & 0 & 0 & 0,001 & 0,002 & 0 & 0 & 0 & 0 \\
0 & -0,001 & 0 & 0 & 0 & -0,001 & 0,002 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0,001 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0-0,001 & 0,002 & 0 \\
0 & 0 & -0,001 & 0,002 & -0,001 & 0 & 0 & 0 & 0 & 0,002 \\
\end{pmatrix}
$$

Расчёт вектора коррелат $К$ в матричном виде:

$$
K = -R^{-1} \cdot W
$$

$$
K = 
\begin{pmatrix}
-47,957 \\
-47,343 \\
-23,898 \\
32,759 \\
14,349 \\
20,171 \\
-5736   \\
-31,288 \\
-2,743  \\
-25,718 \\
\end{pmatrix}
$$

Вычисляем уравненные поправки:

$$
V = P^{-1} \cdot B^T \cdot K
$$

$$
V = 
\begin{pmatrix}
0,017  \\
0,001  \\
0,020  \\
-0,052 \\
0,007  \\
-0,008 \\
0,027  \\
-0,004 \\
0,025  \\
-0,005 \\
-0,018 \\
0,015  \\
-0,006 \\
0,009  \\
-0,027 \\
-0,017 \\
0,002  \\
\end{pmatrix}
$$

Далее найдем уравненные превышения и рассчитаем по ним невязки:

$$
h_n + \nu_n = h_n^{ур}
$$

$$
\begin{pmatrix}
1,879 \\
1,589 \\
1,469 \\
-1,038 \\
4,697 \\
2,680 \\
1,691 \\
-2,028 \\
-0,432 \\
0,073 \\
-0,812 \\
-2,695 \\
-1,788 \\
-0,906 \\
-0,141 \\
1,642 \\
-1,852 \\
\end{pmatrix} + V =
\begin{pmatrix}
1,896 \\
1,590 \\
1,489 \\
-1,090 \\
4,704 \\
-2,672 \\
-0,407 \\
0,068 \\
-0,830 \\
-2,680 \\
-1,794 \\
-0,897 \\
-0,168 \\
1,625 \\
-1,850 \\
\end{pmatrix}
$$

$$
\begin{matrix}
h_4 - h_{12} - h_2 - w_1 = 0 \\
h_2 + h_{10} + h_15 - h_3 - w_2 = 0\\
h_3 - h_{9} - h_1 - h_5 - w_3 = 0 \\
h_7 - h_{4} + h_1 - h_5 - w_4 = 0\\
h_5 + h_{8} - h_6 - w_5 = 0 \\ 
h_9 - h_{16} - h_8 - w_6 = 0 \\
h_{16} - h_{15} - h_{13} - w_7 = 0 \\ 
h_{11} - h_{14} - h_{10} - w_8 = 0 \\
h_{12} - h_{17} - h_{11} - w_9 = 0 \\
h_{1} - h_{5} - (H_{Rp2} - H_{Rp1}) - w_{10} = 0 \\
\end{matrix}
$$

Все невязки равны 0.

Вычислим уравненные отметки реперов:

$$
\begin{cases}
H_1 = H_{M1} + h_1 = 182,385м \\
H_2 = H_{M1} + h_2 = 182,079м \\
H_3 = H_{M1} + h_3 = 181,978м \\
H_4 = H_{M1} + h_4 = 179,399м \\
H_5 = H_{M1} + h_1 + h_8 = 180,353м \\
H_6 = H_{M1} + h_3 - h_15 = 182,146м \\
H_7 = H_{M1} + h_2 + h_{11} = 181,249м \\
\end{cases}
$$

## ОЦЕНКА ТОЧНОСТИ КОРРЕЛАТНОГО СПОСОБА
УРАВНИВАНИЯ

Рассчитаем ковариационную матрицу уравненных превышений:

$$
Q_{ур}^h = P^{-1} - P^{-1} \cdot B^T \cdot R^{-1} \cdot B \cdot P^{-1}
$$

Рассчитаем ковариационную матрицу уравненных отметок реперов:

$$
Q_{ур}^H = A \cdot Q_{ур}^h \cdot A^T
$$

где $А$ – матрица частных производных;

Для составления матрицы А используем формулу переноса ошибок:

$$
F = f \left( a, b \right)
$$

$$
m_F^2 = \left( \frac{\partial F}{\partial a} \right)^2 \cdot m_a^2 + \left( \frac{\partial F}{\partial b} \right)^2 \cdot m_b^2
$$

Например, первая строка матрицы А рассчитывается следующим образом:

$$
H_1 = H_{M1} + h_1
$$

$A = $
$\left( \frac{\partial f}{\partial h_{1}} \right)^2 \cdot m_{h_{1}}^2 + \left( \frac{\partial f}{\partial h_{2}} \right)^2 \cdot m_{h_{2}}^2 + \left( \frac{\partial f}{\partial h_{3}} \right)^2 \cdot m_{h_{3}}^2 + \left( \frac{\partial f}{\partial h_{4}} \right)^2 \cdot m_{h_{4}}^2$
$+\left( \frac{\partial f}{\partial h_{5}} \right)^2 \cdot m_{h_{5}}^2 + \left( \frac{\partial f}{\partial h_{6}} \right)^2 \cdot m_{h_{6}}^2 + \left( \frac{\partial f}{\partial h_{7}} \right)^2 \cdot m_{h_{7}}^2 + \left( \frac{\partial f}{\partial h_{8}} \right)^2 \cdot m_{h_{8}}^2$
$+ \left( \frac{\partial f}{\partial h_{9}} \right)^2 \cdot m_{h_{9}}^2 + \left( \frac{\partial f}{\partial h_{10}} \right)^2 \cdot m_{h_{10}}^2 + \left( \frac{\partial f}{\partial h_{11}} \right)^2 \cdot m_{h_{11}}^2 + \left( \frac{\partial f}{\partial h_{12}} \right)^2 \cdot m_{h_{12}}^2$
$+\left( \frac{\partial f}{\partial h_{13}} \right)^2 \cdot m_{h_{13}}^2 + \left( \frac{\partial f}{\partial h_{14}} \right)^2 \cdot m_{h_{14}}^2 + \left( \frac{\partial f}{\partial h_{15}} \right)^2 \cdot m_{h_{15}}^2$
$+ \left( \frac{\partial f}{\partial h_{16}} \right)^2 \cdot m_{h_{16}}^2 + \left( \frac{\partial f}{\partial h_{17}} \right)^2 \cdot m_{h_{17}}^2$

$$
A = 
\begin{pmatrix}
1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
1 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 \\
0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\
\end{pmatrix}
$$

$$
Q_{ур}^H = 
\begin{pmatrix}
0,00022 & 0,00004 & 0,00010 & 0,00002 & 0,00009 & 0,00006 & 0,00004 \\
0,00004 & 0,00027 & 0,00007 & 0,00016 & 0,00006 & 0,00019 & 0,00020 \\
0,00010 & 0,00007 & 0,00025 & 0,00005 & 0,00012 & 0,00011 & 0,00009 \\
0,00002 & 0,00016 & 0,00005 & 0,00023 & 0,00004 & 0,00013 & 0,00016 \\
0,00009 & 0,00006 & 0,00012 & 0,00004 & 0,00025 & 0,00010 & 0,00008 \\
0,00006 & 0,00019 & 0,00011 & 0,00013 & 0,00010 & 0,00029 & 0,00023 \\
0,00004 & 0,00020 & 0,00009 & 0,00016 & 0,00008 & 0,00023 & 0,00035 \\
\end{pmatrix}
$$

СКП единицы веса:

$$
\mu = \sqrt{\frac{V^T \cdot P \cdot V}{N - t}}
$$

$$
V^t \cdot P \cdot V = 10,536
$$

$$
\mu = 1,026
$$

СКП превышений:

$$
\begin{pmatrix}
m_{h1} \\
m_{h2} \\
m_{h3} \\
m_{h4} \\
m_{h5} \\
m_{h6} \\
m_{h7} \\
m_{h8} \\
m_{h9} \\
m_{h10} \\
m_{h11} \\
m_{h12} \\
m_{h13} \\
m_{h14} \\
m_{h15} \\
m_{h16} \\
m_{h17} \\
\end{pmatrix} = \mu \cdot 
\begin{pmatrix}
\sqrt{Q_{ур11}^h} \\
\sqrt{Q_{ур22}^h} \\
\sqrt{Q_{ур33}^h} \\
\sqrt{Q_{ур44}^h} \\
\sqrt{Q_{ур55}^h} \\
\sqrt{Q_{ур66}^h} \\
\sqrt{Q_{ур77}^h} \\
\sqrt{Q_{ур88}^h} \\
\sqrt{Q_{ур99}^h} \\
\sqrt{Q_{ур1010}^h} \\
\sqrt{Q_{ур1111}^h} \\
\sqrt{Q_{ур1212}^h} \\
\sqrt{Q_{ур1313}^h} \\
\sqrt{Q_{ур1414}^h} \\
\sqrt{Q_{ур1515}^h} \\
\sqrt{Q_{ур1616}^h} \\
\sqrt{Q_{ур1717}^h} \\
\end{pmatrix} =
\begin{pmatrix}
0,015  \\
0,017  \\
0,016  \\
0,016  \\
0,015  \\
0,016  \\
0,016  \\
0,017  \\
0,017  \\
0,014  \\
0,015  \\
0,014  \\
0,019  \\
0,014  \\
0,018  \\
0,017  \\
0,017  \\
\end{pmatrix}
$$

СКП реперов:

$$
\begin{pmatrix}
m_{H1} \\
m_{H2} \\
m_{H3} \\
m_{H4} \\
m_{H5} \\
m_{H6} \\
m_{H7} \\
\end{pmatrix} = \mu \cdot 
\begin{pmatrix}
\sqrt{Q_{ур11}^H} \\
\sqrt{Q_{ур22}^H} \\
\sqrt{Q_{ур33}^H} \\
\sqrt{Q_{ур44}^H} \\
\sqrt{Q_{ур55}^H} \\
\sqrt{Q_{ур66}^H} \\
\sqrt{Q_{ур77}^H} \\
\end{pmatrix} =
\begin{pmatrix}
0,015 \\
0,017 \\
0,016 \\
0,016 \\
0,016 \\
0,017 \\
0,019 \\
\end{pmatrix}
$$

# ПОИСК ГРУБЫХ ОШИБОК В НИВЕЛИРНЫХ ИЗМЕРЕНИЯХ

Для того, чтобы найти грубые ошибки в измерениях, используем
апостериорный метод, а конкретнее $\tau$ – тест. Он заключается в сравнении
нормативных поправок с коэфициентом $\tau$.

Для начала для оценки теоретического значения стандарта определяем
величину $\chi^2$ для нижнего интервала и для верхнего.

И получаем соответственно 3,247 и 20,483.

Найдем нормативные поправки по формуле:

$$
S_{V_i} = \frac{\lvert V_i \rvert}{\mu \cdot \sqrt{Q_{V_i}}}
$$

где $V_i$ - $i$-тая поправка;
$Q_{V_i}$ - $i$-ый элемент ковариационной матрицы поправок.

Ковариационной матрица поправок вычисляется следующим образом:

$$
Q_V = P^{-1} - Q_{ур}^h
$$

Матрица нормативных поправок:

$$
S_V = 
\begin{pmatrix}
0,9102  \\
0,0222  \\
0,7927  \\
2,5002  \\
0,2510  \\
0,4480  \\
1,0753  \\
0,1944  \\
1,4102  \\
0,4341  \\
0,8654  \\
1,2480  \\
0,2173  \\
0,8874  \\
1,4412  \\
0,8468  \\
0,087   \\
\end{pmatrix}
$$

Коэфициент $\tau$ вычисляется по формуле:

$$
\tau = \frac{t \cdot \sqrt{r}}{\sqrt{r - 1 + t^2}}
$$

где $r$ - число степеней свободы;
$t$ - коэффициент Стьюдента (с вероятностью $Р=0,95$).

$$
\tau = 2,421
$$

После проведения сравнения нормативных поправок с коэффициентом $\tau$ с
учетом следующего условия: $S_{V_i} \leq \tau$, была выявлена
одна грубая ошибка $S_{V_6}$ в исходных измерениях, 
так как условие не выполнялось $S_{V_6} \geq \tau$

\strong{Вывод}: В данной работе было выполнено уравнивание коррелатным
способом сети нивелирования III класса, были вычислены уравненные высотные
отметки. Произведены обобщенная оценка точности полученных результатов и
поиск грубых ошибок, используя $\tau$ – тест, который выявил одну грубую ошибку.

# Параметрический способ уравнивания нивелирных сетей

Цель: выполнить уравнивание параметрическим способом сеть нивелирования
IV класса. Вычислить уравненные высотные отметки, произвести обобщенную
оценку точности полученных результатов, проверить наличие грубых ошибок в
измерениях с помощью $\tau$-теста.

Исходные данные, использованные в ходе лабораторной работы, представлены
в таблице 1.

## Таблица 1 – Исходные данные

| От       | До     | Номер хода | h, м   | S, км | Класс |
| -------- | ------ | ---------- | ------ | ----- | ----- |
| $M_{01}$ | $Rp_1$ | 1          | 0,543  | 3,4   | IV    |
| Rp1      | Rp2    | 2          | -1,418 | 5,6   | IV    |
| Rp2      | Rp3    | 3          | 2,336  | 2,7   | IV    |
| Rp3      | M02    | 4          | -2,479 | 5,2   | IV    |
| Rp4      | Rp1    | 5          | 0,762  | 5     | IV    |
| Rp2      | Rp4    | 6          | 0,691  | 2,7   | IV    |
| Rp4      | Rp3    | 7          | 1,665  | 2,6   | IV    |
| M02      | Rp4    | 8          | 0,806  | 5,4   | IV    |

## Таблица 2 – Высотные отметки исходных точек

|           | H,м     |
| --------- | ------- |
| $H_{M01}$ | 102,566 |
| $H_{M02}$ | 101,593 |

# УРАВНИВАНИЕ НИВЕЛИРНОЙ СЕТИ И ОПРЕДЕЛЕНИЕ УРАВНЕННЫХ ОТМЕТОК РЕПЕРОВ

Проанализируем нивелирную сеть, приведённую на рисунке 1.

1. В данной сети четыре избыточных измерений $r = N – t = 8 – 4 = 4$
2.  По числу избыточных измерений необходимо составить четыре условных уравнения поправок.

Условные уравнения поправок будут иметь вид:

$$
\begin{matrix}
h_1 + h_6 + h_5 - w_1 = 0                                          \\
h_3 - h_7 - h_6 - w_2 = 0                                          \\
h_7 + h_4 + h_8 + w_3 = 0                                          \\
h_1 + h_2 + h_3 + h_4 - \left( H_{M_2} - H_{M_1} \right) - w_4 = 0 \\
\end{matrix}
$$

Создаём вектор невязок $W$

$$
W = \begin{pmatrix}
0,035    \\
-0,020   \\
-0,008   \\
-0,045   \\
\end{pmatrix}
$$

Вычисляем допустимые невязки реперов по формуле(1.2) (для IV класса):

$$
w_{доп} = 20 \cdot \sqrt{L}
$$

где $L$ – длина хода, км.

$$
\begin{matrix}
w_{1_доп} = 0,073м   \\
w_{2_доп} = 0,057м   \\
w_{3_доп} = 0,073м   \\
w_{4_доп} = 0,082м   \\
\end{matrix}
$$

Все невязки допустимы.

Назначим параметры

$$
\begin{matrix}
z_1 = H_{Rp_1}^2 = H_{M_1} + h_1          \\
z_2 = H_{Rp_2}^2 = H_{M_1} + h_1 + h_2    \\
z_3 = H_{Rp_3}^2 = H_{M_2} - h_4          \\
z_1 = z_2 = z_3 = z_4 = 0                 \\
\end{matrix}
$$

где $z$ – приближенное значение параметра.

Составим параметрические уравнения связи и вычислим приближенные
значения измерений:

$$
\begin{matrix}
h_1^0 = z_1 - H_{M_1} \\
h_2^0 = z_2 - z_1     \\
h_3^0 = z_3 - z_2     \\
h_4^0 = H_{M_2} - z_3 \\
h_5^0 = z_1 - z_4     \\
h_6^0 = z_4 - z_2     \\
h_7^0 = z_3 - z_4     \\
h_8^0 = z_4 - H_{M_2} \\
\end{matrix}
$$

Найдем элементы вектора свободных членов по формуле:

$$
l_n = h_{выч} - h_{изм}
$$

| № | $h_{выч}$, м | $h_{изм}$, м | $l$, м   |
| - | ------------ | ------------ | -------- |
| 1 | -102,566     | 0,543        | -103,109 |
| 2 | 0            | -1,418       | 1,418    |
| 3 | 0            | 2,336        | -2,336   |
| 4 | 101,593      | -2,479       | 104,072  |
| 5 | 0            | 0,762        | -0,762   |
| 6 | 0            | 0,691        | -0,691   |
| 7 | 0            | 1,665        | -1,665   |
| 8 | -101,593     | 0,806        | -102,399 |

Составим параметрические уравнения поправок

$$
\begin{cases}
v_{1} = a_{11} \cdot z_1 + a_{12} \cdot z_2 + a_{13} \cdot z_3 + a_{14} \cdot z_4 +  l_{1} \\
v_{2} = a_{21} \cdot z_1 + a_{22} \cdot z_2 + a_{23} \cdot z_3 + a_{24} \cdot z_4 +  l_{2} \\
v_{3} = a_{31} \cdot z_1 + a_{32} \cdot z_2 + a_{33} \cdot z_3 + a_{34} \cdot z_4 +  l_{3} \\
v_{4} = a_{41} \cdot z_1 + a_{42} \cdot z_2 + a_{43} \cdot z_3 + a_{44} \cdot z_4 +  l_{4} \\
v_{5} = a_{51} \cdot z_1 + a_{52} \cdot z_2 + a_{53} \cdot z_3 + a_{54} \cdot z_4 +  l_{5} \\
v_{6} = a_{61} \cdot z_1 + a_{62} \cdot z_2 + a_{63} \cdot z_3 + a_{64} \cdot z_4 +  l_{6} \\
v_{7} = a_{71} \cdot z_1 + a_{72} \cdot z_2 + a_{73} \cdot z_3 + a_{74} \cdot z_4 +  l_{7} \\
v_{8} = a_{81} \cdot z_1 + a_{82} \cdot z_2 + a_{83} \cdot z_3 + a_{84} \cdot z_4 +  l_{8} \\
\end{cases}
$$

Создадим матрицу коэффициентов параметрических уравнений поправок $A$
Для составления матрицы $А$ используем формулу переноса ошибок:

$$
F = f(a, b)
$$

$$
m_F^2 = \left(\frac{\partial F}{\partial a} \right) \cdot m_a^2 + \left(\frac{\partial F}{\partial b} \right) \cdot m_b^2
$$

В нашем случае дифференцируем параметрические уравнения связи по каждому
параметру. Например, третья строка матрицы $А$ рассчитывается следующим
образом:

$$
h_3 = z_3 - z_2
$$

$$
m_{h_3}^2 = \left(\frac{\partial f}{\partial z_1} \right)^2 \cdot m_{z_1}^2 + \left(\frac{\partial f}{\partial z_2} \right)^2 \cdot m_{z_2}^2 + \left(\frac{\partial f}{\partial z_3} \right)^2 \cdot m_{z_3}^2 + \left(\frac{\partial f}{\partial z_4} \right)^2 \cdot m_{z_4}^2
$$

$$
m_{h_3}^2 = 0^2 \cdot m_{z_1}^2 + (-1)^2 \cdot m_{z_2}^2 + 1^2 \cdot m_{z_3}^2 + 0^2 \cdot m_{z_4}^2 = 0 - 1 + 1 + 0
$$

$$
A = 
\begin{pmatrix}
1 0 0 0   \\
-1 1 0 0  \\
0 -1 1 0  \\
0 0 -1 0  \\
1 0 0 -1  \\
0 -1 0 1  \\
0 0 1 -1  \\
0 0 0 1   \\
\end{pmatrix}
$$

Создадим диагональную матрицу весов $P$

Где вес рассчитывается по формуле:

$$
P = \left( \frac{1}{\sigma_0 \cdot \sqrt{L}} \right)^2
$$

где $L$ - длина хода, км.

$$
P = 
\begin{pmatrix}
735 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 446 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 926 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 481 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 500 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 926 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 962 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 463 \\
\end{pmatrix}
$$

Контрольные суммы $S$ находим по формуле:

$$
S_n = a_{n_1} + a_{n_2} + a_{n_3} + a_{n_4} + l_n
$$

## Таблица 2 – Контрольные суммы S

| № | S        | № | S        |
| - | -------- | - | -------- |
| 1 | -102,109 | 5 | -0,762   |
| 2 | 1,418    | 6 | -0,691   |
| 3 | -2,336   | 7 | -1,665   |
| 4 | 103,072  | 8 | -101,399 |

Cоставим матрицу коэффициентов нормальных уравнений $N$ и найдем ее
элементы. Матрица коэффициентов нормальных уравнений $N$ имеет вид:

|         | $a_1]$   | $a_2]$   | $a_3]$   | $a_4]$   | $l]$  | $S]$  | $C]$  |
| ------- | -------- | -------- | -------- | -------- | ----- | ----- | ----- |
| $[pa_1$ | $N_{11}$ | $N_{12}$ | $N_{13}$ | $N_{14}$ | $B_1$ | $S_1$ | $C_1$ |
| $[pa_2$ | $N_{21}$ | $N_{22}$ | $N_{23}$ | $N_{24}$ | $B_2$ | $S_2$ | $C_2$ |
| $[pa_3$ | $N_{31}$ | $N_{32}$ | $N_{33}$ | $N_{34}$ | $B_3$ | $S_3$ | $C_3$ |
| $[pa_4$ | $N_{41}$ | $N_{42}$ | $N_{43}$ | $N_{44}$ | $B_4$ | $S_4$ | $C_4$ |

Расчёт матрицы коэффициентов нормальных уравнений $N$ в матричном виде:

$$
N = A^T \cdot P \cdot A
$$

Расчёт матрицы свободных членов нормальных уравнений $B$ в матричном виде:

$$
B = A^T \cdot P \cdot l
$$

## Таблица 3 – Коэффициенты нормальных уравнений

|         | $a_1]$   | $a_2]$   | $a_3]$   | $a_4]$   | $l]$       | $S]$     | $C]$     |
| ------- | -------- | -------- | -------- | -------- | ---------- | -------- | -------- |
| $[pa_1$ | 1681,723 | -446,429 | 0        | -500     | -76829,477 | -102,109 | -102,109 |
| $[pa_2$ | -446,429 | 2298,280 | -925,926 | -925,926 | 3435,813   | 1,418    | 1,418    |
| $[pa_3$ | 0        | -925,926 | 2368,234 | -961,538 | -53798,540 | -2,336   | -2,236   |
| $[pa_4$ | -500     | -925,926 | -961,538 | 2850,427 | -46064,798 | 103,072  | 103,072  |

Для вычисления высот определяемых реперов, необходимо создать схему Гаусса
и найти ее элементы.

## Таблица 4 – схема Гаусса

|           | $H_{Rp_1}$ | $H_{Rp_2}$ | $H_{Rp_4}$   | $H_{Rp_4}$   | B         | S         | C         |
| --------- | ---------- | ---------- | ------------ | ------------ | --------- | --------- | --------- |
| N_1       | $N_{11}$   | $N_{12}$   | $N_{13}$     | $N_{14}$     | $B_1$     | $S_1$     | $C_1$     |
| $E_1$     | –1         | $E_{12}$   | $E_{13}$     | $E_{14}$     | $E_{B_1}$ | $E_{B_1}$ | $C_1$     |
| $N_ 2$    |            | $N_{22}$   | $N_{23}$     | $N_{24}$     | $B_2$     | $S_2$     |           |
| N_2^{(1)} |            | N_{22}^(1) | N_{23}^(1)   | N_{24}^(1)   | B_2^(1)   | S_2^(1)   | C_2^(1)   |
| E_2       |            | -1         | E_{23}       | E_{24}       | E_{B_2}   | E_{S_2}   | C_2       |
| N_3       |            |            | N_{33}       | N_{34}       | B_3       | S_3       |           |
| N_3^{(2)} |            |            | N_{33}^{(2)} | N_{34}^{(2)} | N_3^{(2)} | N_3^{(2)} | C_3^{(2)} |
| N_3^{(2)} |            |            | -1           | E_{34}       | E_{B_3}   | E_{S_3}   | C_4       |

$N_i$ - эквивалентная строка
$N_i^{(n)}$ - эквивалентная строка после $n$-го преобразования;
$E_i$ - – элиминационная строка;

Например, элемент $E_{23}$ рассчитывается, как

$$
E_{23} = -\frac{N_{23}^{1}}{N_{22}^{(1)}}
$$

Элемент $N_33^{(2)}$ рассчитывается, как

$$
N_{33}^{(2)} = N_{13} \cdot E_{13} + N_{23}^{(1)} \cdot E_{23} + N_{33}
$$

Непосредственно сами высоты вычисляются следующим образом:

$$
\begin{matrix}
H_{Rp_4} = E_{B_4} \\
H_{Rp_4} = -E_{34} \cdot H_{Rp_4} - E_{B_3} \\
H_{Rp_2} = -E_{23} \cdot H_{Rp_3} - E_{24} \cdot H_{Rp_4} - E_{B_2} \\
H_{Rp_1} = -E_{12} \cdot H_{Rp_2} - E_{13} \cdot H_{Rp_3} - E_{14} \cdot H_{Rp_4} - E_{B_1} \\
\end{matrix}
$$

Расчёт вектора высот $H$ в матричном виде

$$
H = -N^{-1} \cdot B
$$

$$
H = \begin{pmatrix}
102,3898 \\
104,0543 \\
101,7085 \\
103,1264 \\
\end{pmatrix}
$$

Далее вычисляем уравненные превышения

$$
\begin{matrix}
h_1^{ур} = H_{Rp_1} - H_{M_1} \\
h_2^{ур} = H_{Rp_2} - H_{Rp_1} \\
h_3^{ур} = H_{Rp_3} - H_{Rp_2} \\
h_4^{ур} = H_{M_2} - H_{Rp_3} \\
h_5^{ур} = H_{Rp_1} - H_{Rp_1} \\
h_6^{ур} = H_{Rp_4} - H_{Rp_2} \\
h_7^{ур} = H_{Rp_3} - H_{Rp_4} \\
h_8^{ур} = H_{Rp_4} - H_{M_2} \\
\end{matrix}
$$

Вычисляем уравненные поправки

$$
\nu_n = h_n^{ур} - h_n
$$

$$
h^{ур} = \begin{pmatrix}
0,560   \\
1, 418  \\
2,346   \\
2, 461  \\
0,737   \\
0,681   \\
1,664   \\
0,797   \\
\end{pmatrix}
$$

$$
\nu = \begin{pmatrix}
0,0174   \\
0,0001   \\
0,0098   \\
0,0177   \\
-0, 2254 \\
-0,0097  \\
-0,0005  \\
-0,0092  \\
\end{pmatrix}
$$

Далее по уравненным превышениям рассчитаем невязки.

$$
\begin{matrix}
w_1 = h_1 + h_6 + h_5 = 0 \\
w_2 = h_3 - h_7 - h_6 = 0 \\
w_3 = h_7 + h_4 + h_8 = 0 \\
w_4 = h_1 + h_2 + h_3 + h_4 + \left(H_{M_2} - H_{M_1} \right) = 0 \\
\end{matrix}
$$

Все невязки равны 0.

Проверяем отметки реперов вычислив их несколькими способами, т.е. через
разные превышения:

$$
\begin{cases}
H_{Rp_4} = H_{M_1} + h_1^{ур} - h_5^{ур} = 102,3898м \\
H_{Rp_4} = H_{M_1} + h_1^{ур} + h_2^{ур} + h_6^{ур} = 102,3898м \\
H_{Rp_4} = H_{M_2} + h_8^{ур} = 102,3898м \\
\end{cases}
$$

## ОЦЕНКА ТОЧНОСТИ ПАРАМЕТРИЧЕСКОГО СПОСОБА УРАВНИВАНИЯ

Рассчитаем ковариационную матрицу уравненных превышений

$$
Q_{уп}^h = A \cdot N^{-1} \cdot A^T
$$

$$
Q_{ур}^h = \begin{pmatrix}
0.0009 & -0.0004 & -0.0001 & -0.0004 & 0.0004 & -0.0004 & -0.0001 & 0.0004  \\
-0.0004 & 0.0010 & -0.0003 & -0.0003 & -0.0006 & -0.0006 & 0.0001 & 0.0002  \\
-0.0001 & -0.0003 & 0.0006 & -0.0002 & -0.0001 & 0.0001 & 0.0003 & -0.0001  \\
-0.0004 & -0.0003 & -0.0002 & 0.0009 & 0.0002 & 0.0002 & -0.0003 & -0.0006  \\
0.0004 & -0.0006 & -0.0001 & 0.0002 & 0.0008 & -0.0008 & 0.0002 & -0.0004   \\
-0.0001 & -0.0004 & 0.0003 & 0.0001 & -0.0002 & 0.0002 & -0.0003 & 0.0002   \\
-0.0001 & 0.0001 & 0.0003 & -0.0003 & 0.0002 & -0.0002 & 0.0006 & -0.0002   \\
0.0004 & 0.0002 & -0.0001 & -0.0006 & -0.0004 & 0.0004 & -0.0002 & 0.0008   \\
\end
$$

Рассчитаем ковариационную матрицу уравненных отметок реперов

$$
Q_{ур}^H = N^{-1}
$$

$$
Q_{ур}^H = \begin{pmatrix}
0.0009 & 0.0005 & 0.0004 & 0.0004     \\
0.0005 & 0.0011 & 0.0007 & 0.0007     \\
0.0004 & 0.0007 & 0.0009 & 0.0006     \\
0.0004 & 0.0007 & 0.0006 & 0.0008     \\
\end{pmatrix}
$$

СКП единицы веса

$$
\nu = \sqrt{\frac{V^T \cdot P \cdot V}{N - t}}
$$

где $V^t \cdot P \cdot V = 0,9111$, $\nu = 0,477$

СКП превышений 

$$
\begin{pmatrix}
m_{h_1} \\
m_{h_2} \\
m_{h_3} \\
m_{h_4} \\
m_{h_5} \\
m_{h_6} \\
m_{h_7} \\
m_{h_8} \\
\end{pmatrix} = \nu \cdot \begin{pmatrix}
\sqrt{Q_{ур_{11}}^h} \\
\sqrt{Q_{ур_{22}}^h} \\
\sqrt{Q_{ур_{33}}^h} \\
\sqrt{Q_{ур_{44}}^h} \\
\sqrt{Q_{ур_{55}}^h} \\
\sqrt{Q_{ур_{66}}^h} \\
\sqrt{Q_{ур_{77}}^h} \\
\sqrt{Q_{ур_{88}}^h} \\
\end{pmatrix} = \begin{pmatrix}
0,0139 \\
0,0148 \\
0,0120 \\
0,0146 \\
0,0138 \\
0,0116 \\
0,0114 \\
0,0139 \\
\end{pmatrix}
$$

СКП реперов

$$
\begin{pmatrix}
m_{H_1} \\
m_{H_2} \\
m_{H_3} \\
m_{H_4} \\
\end{pmatrix} = \nu \cdot \begin{pmatrix}
\sqrt{Q_{ур_{11}}^H} \\
\sqrt{Q_{ур_{22}}^H} \\
\sqrt{Q_{ур_{33}}^H} \\
\sqrt{Q_{ур_{44}}^H} \\
\end{pmatrix} = \begin{pmatrix}
0.0139    \\
0.0157    \\
0.0146    \\
 0.0139   \\
\end{pmatrix}
$$

## ПОИСК ГРУБЫХ ОШИБОК В ИЗМЕРЕНИЯХ

Для того, чтобы найти грубые ошибки в измерениях, используем апостериорный метод, а конкретнее $\tau$ – тест Он заключается в сравнении нормативных поправок с коэффициентом $\tau$.
Для начала для оценки теоретического значения стандарта определяем величину  $\phi^2$ для нижнего интервала и для верхнего.

$$
\begin{matrix}
\phi_{нижн}^2 = 0,484 \\
\phi_{верх}^2 = 11,143 \\
\end{matrix}
$$

Найдем нормативные поправки по формуле:

$$
S_{V_i} = \frac{\abs{V_i}}{\nu \cdot \sqrt{Q_{V_i}}}
$$

,где $V_i$ - $i$-тая поправка.

$Q_{V_i}$ - $i$-ый ковариационной матрицы поправок.

Ковариационной матрица поправок вычисляется следующим образом:

$$
Q_V = P^{-1} \cdot Q_{ур}^h
$$

Матрица нормативных поправок:

$$
S_V = \begin{pmatrix}
1,6140 \\
0,0078 \\
0,9653 \\
1,0997 \\
1,5643 \\
0,9159 \\
0,0523 \\
0,5315 \\
\end{pmatrix}
$$

Коэффициент $\tau$  вычисляется по формуле:

$$
\tau = \frac{t \cdot \sqrt{r}}{\sqrt{r - 1 + t^2}}
$$

,где $r$ - число степеней свободы; $t$ - коэффициент Стьюдента (с вероятностью $Р=0,95$).

$$
\tau = 1,903
$$

После проведения сравнения нормативных поправок с коэффициентом $\tau$ с
учетом следующего условия: $S_{V_i} \leq \tau$, было выявлено отсутствие грубых
ошибок в исходных измерениях, так как условие выполнялось.

*Вывод*: В данной работе было выполнено уравнивание параметрическим
способом нивелирной сети IV класса, вычислены уравненные высотные отметки.
Произведена обобщенная оценка точности полученных результатов и проверено
наличие грубых ошибок с помощью τ-теста, который не выявил грубых ошибок
в измерениях.